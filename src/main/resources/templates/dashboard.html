<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>Fruta Shop - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #FFF5E6 0%, #FFF9F0 100%);
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, #E8670F 0%, #D85A06 100%);
            box-shadow: 2px 0 8px rgba(0,0,0,0.15);
            position: fixed;
            left: 0;
            top: 60px;
            height: calc(100vh - 60px);
            overflow-y: auto;
            z-index: 40;
            padding: 12px 0;
        }
        
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
        }
        
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 11px 16px;
            color: rgba(255,255,255,0.85);
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            gap: 12px;
            margin: 0 6px;
            border-radius: 0 8px 8px 0;
        }
        
        .nav-item i {
            font-size: 18px;
            min-width: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.15);
            color: #FFFFFF;
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: rgba(255,255,255,0.25);
            border-left-color: #FFFFFF;
            color: white;
            font-weight: 600;
        }
        
        .nav-item.active i {
            transform: scale(1.1);
        }
        
        .nav-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: rgba(255,255,255,0.6);
            padding: 12px 16px 6px 16px;
            font-weight: 700;
            margin-top: 4px;
        }
        
        .nav-divider {
            height: 1px;
            background: rgba(255,255,255,0.15);
            margin: 8px 10px;
        }
        
        .main-content {
            margin-left: 260px;
            padding-top: 5px;
        }
        
        .section {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Content Cards */
        .content-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #E8EAED;
        }
        
        .content-header {
            padding: 16px 20px;
            border-bottom: 1px solid #E8EAED;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .content-header h2 {
            font-size: 18px;
            font-weight: 600;
            color: #202124;
        }
        
        .content-header i {
            font-size: 20px;
            margin-right: 8px;
            color: #E8670F;
        }
        
        .content-body {
            padding: 16px 20px;
        }
        
        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #E8670F 0%, #D85A06 100%);
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(232, 103, 15, 0.3);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
                margin-top: 0;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                padding: 8px 0;
            }
            
            .main-content {
                margin-left: 0;
                padding-top: 0;
            }
            
            .nav-item {
                display: inline-flex;
                padding: 10px 12px;
                margin: 0 4px;
                border-left: 0;
                border-bottom: 3px solid transparent;
                border-radius: 0;
            }
            
            .nav-item:hover {
                transform: none;
            }
            
            .nav-item.active {
                border-left: 0;
                border-bottom: 3px solid white;
            }
            
            .nav-label {
                display: none;
            }
            
            .nav-divider {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50 border-b-4 border-orange-600">
        <div class="px-6 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="bg-gradient-to-br from-orange-600 to-orange-500 p-2 rounded-lg">
                        <i class="fas fa-apple-alt text-2xl text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">Fruta Shop</h1>
                        <p class="text-xs text-orange-600 font-medium">Gerenciador de Pedidos</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-orange-600 to-orange-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
                            <i class="fas fa-user text-xs"></i>
                        </div>
                        <span id="userNameDisplay" class="text-sm text-gray-700 font-medium"></span>
                    </div>
                    <button onclick="logout()" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition duration-200 text-sm font-medium">
                        <i class="fas fa-sign-out-alt mr-1"></i>Sair
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <nav>
            <div class="nav-label">Menu</div>
            
            <div class="nav-item active" data-section="frutas">
                <i class="fas fa-leaf"></i>
                <span>Gerenciar Frutas</span>
            </div>
            
            <div class="nav-item" data-section="catalogo">
                <i class="fas fa-shopping-basket"></i>
                <span>Cat√°logo</span>
            </div>
            
            <div class="nav-item" data-section="pedidos">
                <i class="fas fa-box-open"></i>
                <span>Meus Pedidos</span>
            </div>
            
            <div class="nav-divider"></div>
            
            <div class="nav-label">Conta</div>
            
            <div class="nav-item" onclick="logout()" style="cursor: pointer;">
                <i class="fas fa-sign-out-alt"></i>
                <span>Sair</span>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container mx-auto px-4 py-8">
            <!-- Frutas Tab -->
            <div class="section hidden" id="frutas-section">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                        <h2 class="text-2xl font-bold text-gray-900">
                            <i class="fas fa-leaf mr-2 text-green-600"></i>Gerenciar Frutas
                        </h2>
                        <button onclick="openFrutaModal()" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                            <i class="fas fa-plus mr-2"></i>Adicionar Fruta
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <input type="text" id="searchFruta" placeholder="üîç Buscar por nome..." 
                            class="px-4 py-3 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500">
                        <select id="filterCategoria" 
                            class="px-4 py-3 rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:border-orange-500 cursor-pointer">
                            <option value="">Todas as Categorias</option>
                            <option value="Ma√ß√£">üçé Ma√ß√£</option>
                            <option value="Banana">üçå Banana</option>
                            <option value="Morango">üçì Morango</option>
                            <option value="Laranja">üçä Laranja</option>
                            <option value="Uva">üçá Uva</option>
                        </select>
                    </div>
                    
                    <div id="frutasGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></div>
                </div>
            </div>

            <!-- Cat√°logo Tab (Para Comprar) -->
            <div class="section hidden" id="catalogo-section">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">
                        <i class="fas fa-shopping-basket mr-2 text-orange-600"></i>Cat√°logo - Compre Frutas
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <input type="text" id="searchFrutaCatalogo" placeholder="üîç Buscar por nome..." 
                            class="px-4 py-3 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500">
                        <select id="filterCategoriaCatalogo" 
                            class="px-4 py-3 rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:border-orange-500 cursor-pointer">
                            <option value="">Todas as Categorias</option>
                            <option value="Ma√ß√£">üçé Ma√ß√£</option>
                            <option value="Banana">üçå Banana</option>
                            <option value="Morango">üçì Morango</option>
                            <option value="Laranja">üçä Laranja</option>
                            <option value="Uva">üçá Uva</option>
                        </select>
                    </div>
                    
                    <div id="catalogoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></div>
                </div>
            </div>

            <!-- Pedidos Tab -->
            <div class="section hidden" id="pedidos-section">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">
                        <i class="fas fa-shopping-cart mr-2 text-orange-600"></i>Meus Pedidos
                    </h2>
                    <div id="pedidosLista" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal - Fruta -->
    <div id="frutaModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="bg-gradient-to-r from-orange-600 to-yellow-500 p-6 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h2 id="modalTitle" class="text-2xl font-bold text-white">Adicionar Fruta</h2>
                    <button onclick="closeFrutaModal()" class="text-white hover:bg-white hover:bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <form id="frutaForm" class="p-6 space-y-4">
                <input type="hidden" id="frutaId">
                
                <!-- Image Preview -->
                <div class="border-2 border-dashed border-orange-300 rounded-lg p-4 text-center bg-orange-50">
                    <div id="imagePreview" class="h-40 flex items-center justify-center">
                        <i class="fas fa-apple-alt text-6xl text-orange-300"></i>
                    </div>
                    <label for="frutaFoto" class="mt-4 inline-block bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg cursor-pointer transition">
                        <i class="fas fa-upload mr-2"></i>Escolher Imagem
                    </label>
                    <input type="file" id="frutaFoto" accept="image/*" class="hidden">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="frutaNome" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-signature mr-2 text-orange-600"></i>Nome *
                        </label>
                        <input type="text" id="frutaNome" required 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="Ma√ß√£ Fuji">
                    </div>
                    
                    <div>
                        <label for="frutaCategoria" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-tags mr-2 text-orange-600"></i>Categoria *
                        </label>
                        <select id="frutaCategoria" required 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:border-orange-500">
                            <option value="">Selecione...</option>
                            <option value="Ma√ß√£">Ma√ß√£</option>
                            <option value="Banana">Banana</option>
                            <option value="Morango">Morango</option>
                            <option value="Laranja">Laranja</option>
                            <option value="Uva">Uva</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="frutaPreco" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-dollar-sign mr-2 text-yellow-600"></i>Pre√ßo (R$) *
                        </label>
                        <input type="number" id="frutaPreco" required step="0.01" min="0" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="5.50">
                    </div>
                    
                    <div>
                        <label for="frutaEstoque" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-box mr-2 text-orange-600"></i>Estoque (Kg) *
                        </label>
                        <input type="number" id="frutaEstoque" required min="0" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="100">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label for="frutaCor" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-palette mr-2 text-red-600"></i>Cor
                        </label>
                        <input type="text" id="frutaCor" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="Vermelho">
                    </div>
                    
                    <div>
                        <label for="frutaSabor" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-smile mr-2 text-pink-600"></i>Sabor
                        </label>
                        <select id="frutaSabor" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:border-orange-500">
                            <option value="">Selecione...</option>
                            <option value="Doce">Doce</option>
                            <option value="√Åcido">√Åcido</option>
                            <option value="Neutro">Neutro</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="frutaOrigem" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-globe mr-2 text-blue-600"></i>Origem
                        </label>
                        <input type="text" id="frutaOrigem" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="Brasil">
                    </div>
                </div>

                <div>
                    <label for="frutaUnidade" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-ruler mr-2 text-purple-600"></i>Unidade de Medida
                    </label>
                    <input type="text" id="frutaUnidade" 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                        placeholder="Kg">
                </div>
                
                <div>
                    <label for="frutaDescricao" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-align-left mr-2 text-gray-600"></i>Descri√ß√£o
                    </label>
                    <textarea id="frutaDescricao" rows="3" 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                        placeholder="Descreva a fruta..."></textarea>
                </div>
                
                <div class="flex flex-wrap gap-4">
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="frutaOrganico" class="w-5 h-5 text-orange-600 rounded focus:ring-2 focus:ring-orange-500">
                        <span class="text-gray-800"><i class="fas fa-leaf mr-1 text-green-600"></i>Org√¢nico</span>
                    </label>
                    
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="frutaPromo" class="w-5 h-5 text-orange-600 rounded focus:ring-2 focus:ring-orange-500">
                        <span class="text-gray-800"><i class="fas fa-tag mr-1 text-red-600"></i>Em Promo√ß√£o</span>
                    </label>
                    
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" id="frutaDisponivel" checked class="w-5 h-5 text-orange-600 rounded focus:ring-2 focus:ring-orange-500">
                        <span class="text-gray-800"><i class="fas fa-check-circle mr-1 text-green-600"></i>Dispon√≠vel</span>
                    </label>
                </div>
                
                <div class="flex gap-4 pt-4 border-t-2 border-gray-200">
                    <button type="button" onclick="closeFrutaModal()" 
                        class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg font-semibold transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" 
                        class="flex-1 bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                        <i class="fas fa-save mr-2"></i>Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal - Pedido -->
    <div id="pedidoModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="bg-gradient-to-r from-orange-600 to-orange-500 p-6 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h2 id="pedidoModalTitle" class="text-2xl font-bold text-white">Fazer Pedido</h2>
                    <button onclick="closePedidoModal()" class="text-white hover:bg-white hover:bg-opacity-20 rounded-full w-10 h-10 flex items-center justify-center transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <form id="pedidoForm" class="p-6 space-y-4">
                <input type="hidden" id="pedidoFrutaId">
                
                <div class="bg-orange-50 rounded-lg p-4 mb-4 border-2 border-orange-200">
                    <label class="block text-gray-800 font-semibold mb-2">Fruta Selecionada</label>
                    <div id="selectedFrutaInfo" class="text-orange-900 font-semibold text-lg"></div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="pedidoQuantidade" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-shopping-bag mr-2 text-orange-600"></i>Quantidade (Kg) *
                        </label>
                        <input type="number" id="pedidoQuantidade" required step="0.1" min="0.1" 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                            placeholder="1">
                    </div>
                    
                    <div>
                        <label for="pedidoTotal" class="block text-gray-800 font-semibold mb-2">
                            <i class="fas fa-dollar-sign mr-2 text-yellow-600"></i>Total (R$)
                        </label>
                        <input type="text" id="pedidoTotal" readonly 
                            class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 bg-gray-50" 
                            placeholder="0.00">
                    </div>
                </div>
                
                <div>
                    <label for="pedidoEndereco" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-map-marker-alt mr-2 text-red-600"></i>Endere√ßo de Entrega *
                    </label>
                    <input type="text" id="pedidoEndereco" required 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                        placeholder="Rua, n√∫mero, bairro, cidade">
                </div>
                
                <div>
                    <label for="pedidoTelefone" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-phone mr-2 text-blue-600"></i>Telefone para Contato
                    </label>
                    <input type="tel" id="pedidoTelefone" 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                        placeholder="(11) 9XXXX-XXXX">
                </div>

                <div>
                    <label for="pedidoDataEntrega" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-calendar mr-2 text-purple-600"></i>Data de Entrega Desejada
                    </label>
                    <input type="date" id="pedidoDataEntrega" 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 focus:outline-none focus:border-orange-500">
                </div>
                
                <div>
                    <label for="pedidoObservacoes" class="block text-gray-800 font-semibold mb-2">
                        <i class="fas fa-note-sticky mr-2 text-yellow-600"></i>Observa√ß√µes
                    </label>
                    <textarea id="pedidoObservacoes" rows="2" 
                        class="w-full px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-500" 
                        placeholder="Alguma observa√ß√£o especial?"></textarea>
                </div>
                
                <div class="flex gap-4 pt-4 border-t-2 border-gray-200">
                    <button type="button" onclick="closePedidoModal()" 
                        class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg font-semibold transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" 
                        class="flex-1 bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                        <i class="fas fa-check-circle mr-2"></i>Confirmar Pedido
                    </button>
                </div>
        </div>
    </div>

    <script src="/js/dashboard.js"></script>
</body>
</html>
